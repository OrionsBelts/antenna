---
name: bootstrap

on: push

jobs:
  secrets:
    name: Manage Secrets
    runs-on: macOS-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v2

      - name: Install dependencies
        run: |
          # Installing dependecies
          brew install python-yq faas-cli
          # Check versions; validate deps
          jq --version
          yq --version

      - name: Run bootstrap
        env:
          OPENFAAS_URL: ${{ secrets.OPENFAAS_URL }}
          OPENFAAS_PREFIX: ""
          SECRETS: ${{ toJson(secrets) }}
        run: |
          # Running bootstrap script
          cd ${GITHUB_WORKSPACE}/core
          bash ./bootstrap.sh
